2026-02-17 11:11:36,782 - CubieApp - INFO - LLM Classification: <MagicMock name='Client().models.generate_content().text.strip().upper()' id='1936691859856'> for query: 'What is the capital of France?'
2026-02-17 11:11:36,783 - CubieApp - INFO - Query='What is the capital of France?...', explicit_mode='help', detected_intent='help'
2026-02-17 11:11:36,785 - CubieApp - ERROR - Document search failed: shapes (0,) and (3072,) not aligned: 0 (dim 0) != 3072 (dim 0)
2026-02-17 11:11:36,785 - CubieApp - ERROR - Gemini API Error: 429 429 Resource Exhausted
2026-02-17 11:11:36,785 - CubieApp - ERROR - Global error: 'charmap' codec can't encode characters in position 7-8: character maps to <undefined>
Traceback (most recent call last):
  File "E:\QB\CubieHelp-main\reproduce_429.py", line 45, in test_429_error
    print(f"Reply: {body.get('reply')}")
  File "C:\Users\logis\AppData\Local\Programs\Python\Python311\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode characters in position 7-8: character maps to <undefined>
2026-02-17 11:16:13,866 - CubieApp - INFO - LLM Classification: <MagicMock name='Client().models.generate_content().text.strip().upper()' id='2682170871696'> for query: 'What is the capital of France?'
2026-02-17 11:16:13,868 - CubieApp - INFO - Query='What is the capital of France?...', explicit_mode='help', detected_intent='help'
2026-02-17 11:16:13,870 - CubieApp - ERROR - Document search failed: shapes (0,) and (3072,) not aligned: 0 (dim 0) != 3072 (dim 0)
2026-02-17 11:16:13,870 - CubieApp - ERROR - Gemini API Error: 429 429 Resource Exhausted
2026-02-17 11:17:55,792 - CubieApp - INFO - LLM Classification: <MagicMock name='Client().models.generate_content().text.strip().upper()' id='1940580620432'> for query: 'What is the capital of France?'
2026-02-17 11:17:55,793 - CubieApp - INFO - Query='What is the capital of France?...', explicit_mode='help', detected_intent='help'
2026-02-17 11:17:55,796 - CubieApp - ERROR - Document search failed: shapes (0,) and (3072,) not aligned: 0 (dim 0) != 3072 (dim 0)
2026-02-17 11:17:55,796 - CubieApp - ERROR - Gemini API Error: 429 429 Resource Exhausted
2026-02-17 11:20:28,030 - CubieApp - INFO - Incoming request: GET /
2026-02-17 11:20:28,032 - CubieApp - INFO - Completed request: GET / - Status: 200 - Time: 2.51ms
2026-02-17 11:20:28,050 - CubieApp - INFO - Incoming request: GET /static/login.css
2026-02-17 11:20:28,084 - CubieApp - INFO - Completed request: GET /static/login.css - Status: 200 - Time: 34.32ms
2026-02-17 11:20:28,088 - CubieApp - INFO - Incoming request: GET /static/login.js
2026-02-17 11:20:28,088 - CubieApp - INFO - Completed request: GET /static/login.js - Status: 200 - Time: 0.00ms
2026-02-17 11:20:28,090 - CubieApp - INFO - Incoming request: GET /static/cubie.png
2026-02-17 11:20:28,091 - CubieApp - INFO - Completed request: GET /static/cubie.png - Status: 200 - Time: 1.00ms
2026-02-17 11:20:35,356 - CubieApp - INFO - Incoming request: POST /api/login
2026-02-17 11:20:40,736 - CubieApp - INFO - Completed request: POST /api/login - Status: 401 - Time: 5380.67ms
2026-02-17 11:20:45,750 - CubieApp - INFO - Incoming request: POST /api/login
2026-02-17 11:20:50,925 - CubieApp - INFO - Completed request: POST /api/login - Status: 200 - Time: 5174.65ms
2026-02-17 11:20:50,934 - CubieApp - INFO - Incoming request: GET /
2026-02-17 11:20:50,936 - CubieApp - INFO - Completed request: GET / - Status: 200 - Time: 2.15ms
2026-02-17 11:20:50,948 - CubieApp - INFO - Incoming request: GET /public/styles.css
2026-02-17 11:20:50,949 - CubieApp - INFO - Incoming request: GET /public/cubie.png
2026-02-17 11:20:50,949 - CubieApp - INFO - Incoming request: GET /public/chat.js
2026-02-17 11:20:50,955 - CubieApp - INFO - Completed request: GET /public/cubie.png - Status: 200 - Time: 6.01ms
2026-02-17 11:20:50,955 - CubieApp - INFO - Completed request: GET /public/styles.css - Status: 200 - Time: 7.10ms
2026-02-17 11:20:50,957 - CubieApp - INFO - Completed request: GET /public/chat.js - Status: 200 - Time: 7.90ms
2026-02-17 11:21:09,419 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 11:21:09,420 - CubieApp - INFO - Query='What are the top 5 carriers as per shipment disput...', explicit_mode='analytics', detected_intent='analytics'
2026-02-17 11:21:11,736 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 11:21:11,738 - root - INFO - SQL run: SELECT TOP 5 CarrierCode, COUNT(*) AS DisputeCount FROM DisputeManagement GROUP BY CarrierCode ORDER BY DisputeCount DESC
2026-02-17 11:21:15,966 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 11:21:15,968 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 6548.63ms
2026-02-17 11:21:32,916 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 11:21:32,917 - CubieApp - INFO - Query='Give this to me in a bar chart...', explicit_mode='analytics', detected_intent='visualization'
2026-02-17 11:21:34,751 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 11:21:38,004 - root - INFO - Saving interactive chart to public/demo\5546a6be27ce4554891a52fd2507e99d.html
2026-02-17 11:21:38,013 - root - INFO - Chart HTML saved successfully.
2026-02-17 11:21:40,310 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 11:21:40,311 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 7395.62ms
2026-02-17 11:21:40,900 - CubieApp - INFO - Incoming request: GET /static/demo/5546a6be27ce4554891a52fd2507e99d.html
2026-02-17 11:21:40,903 - CubieApp - INFO - Completed request: GET /static/demo/5546a6be27ce4554891a52fd2507e99d.html - Status: 200 - Time: 2.51ms
2026-02-17 11:21:43,839 - CubieApp - INFO - Incoming request: GET /static/demo/5546a6be27ce4554891a52fd2507e99d.html
2026-02-17 11:21:43,842 - CubieApp - INFO - Completed request: GET /static/demo/5546a6be27ce4554891a52fd2507e99d.html - Status: 304 - Time: 2.30ms
2026-02-17 11:22:16,535 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 11:22:16,536 - CubieApp - INFO - Query='email this to me odeshpande@tcube360.com...', explicit_mode='analytics', detected_intent='email'
2026-02-17 11:22:18,522 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 11:22:18,525 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 1990.26ms
2026-02-17 11:22:22,766 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 11:22:22,766 - CubieApp - INFO - Query='send the bar chart...', explicit_mode='analytics', detected_intent='visualization'
2026-02-17 11:22:22,766 - CubieApp - INFO - User approved email in analytics mode, checking for draft...
2026-02-17 11:22:24,937 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 11:22:24,940 - CubieApp - INFO - Resolved emails for ['odeshpande@tcube360.com']: ['odeshpande@tcube360.com']
2026-02-17 11:22:24,948 - CubieApp - INFO - Successfully attached: 5546a6be27ce4554891a52fd2507e99d.html
2026-02-17 11:22:24,949 - CubieApp - WARNING - File not found, skipping: top_5_carriers_by_shipment_dispute_bar_chart.png
2026-02-17 11:22:24,963 - CubieApp - INFO - Attempting to connect to SMTP server smtp.gmail.com:587
2026-02-17 11:22:50,375 - CubieApp - INFO - Email sent successfully to ['odeshpande@tcube360.com']
2026-02-17 11:22:52,544 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 11:22:52,549 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 29784.16ms
2026-02-17 11:22:52,549 - CubieApp - INFO - Incoming request: GET /.well-known/appspecific/com.chrome.devtools.json
2026-02-17 11:22:52,550 - CubieApp - INFO - Completed request: GET /.well-known/appspecific/com.chrome.devtools.json - Status: 404 - Time: 1.54ms
2026-02-17 12:07:37,326 - CubieApp - INFO - Incoming request: GET /
2026-02-17 12:07:37,328 - CubieApp - INFO - Completed request: GET / - Status: 200 - Time: 1.54ms
2026-02-17 12:07:37,344 - CubieApp - INFO - Incoming request: GET /static/login.css
2026-02-17 12:07:37,383 - CubieApp - INFO - Completed request: GET /static/login.css - Status: 200 - Time: 38.45ms
2026-02-17 12:07:37,385 - CubieApp - INFO - Incoming request: GET /static/login.js
2026-02-17 12:07:37,385 - CubieApp - INFO - Completed request: GET /static/login.js - Status: 200 - Time: 0.57ms
2026-02-17 12:07:37,386 - CubieApp - INFO - Incoming request: GET /static/cubie.png
2026-02-17 12:07:37,388 - CubieApp - INFO - Completed request: GET /static/cubie.png - Status: 200 - Time: 1.50ms
2026-02-17 12:07:43,994 - CubieApp - INFO - Incoming request: POST /api/login
2026-02-17 12:07:49,113 - CubieApp - INFO - Completed request: POST /api/login - Status: 200 - Time: 5119.11ms
2026-02-17 12:07:49,120 - CubieApp - INFO - Incoming request: GET /
2026-02-17 12:07:49,127 - CubieApp - INFO - Completed request: GET / - Status: 200 - Time: 5.46ms
2026-02-17 12:07:49,138 - CubieApp - INFO - Incoming request: GET /public/styles.css
2026-02-17 12:07:49,139 - CubieApp - INFO - Incoming request: GET /public/cubie.png
2026-02-17 12:07:49,139 - CubieApp - INFO - Incoming request: GET /public/chat.js
2026-02-17 12:07:49,143 - CubieApp - INFO - Completed request: GET /public/styles.css - Status: 200 - Time: 3.31ms
2026-02-17 12:07:49,144 - CubieApp - INFO - Completed request: GET /public/chat.js - Status: 200 - Time: 4.53ms
2026-02-17 12:07:49,144 - CubieApp - INFO - Completed request: GET /public/cubie.png - Status: 200 - Time: 4.53ms
2026-02-17 12:08:21,880 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 12:08:21,881 - CubieApp - INFO - Query='Give me bar chart for top 5 carriers as per disput...', explicit_mode='analytics', detected_intent='visualization'
2026-02-17 12:08:24,480 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:08:27,706 - root - INFO - Saving interactive chart to public/demo\7604c5fc427c41159add314860f24b71.html
2026-02-17 12:08:27,714 - root - INFO - Chart HTML saved successfully.
2026-02-17 12:08:29,723 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:08:29,725 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 7845.56ms
2026-02-17 12:08:30,572 - CubieApp - INFO - Incoming request: GET /static/demo/7604c5fc427c41159add314860f24b71.html
2026-02-17 12:08:30,575 - CubieApp - INFO - Completed request: GET /static/demo/7604c5fc427c41159add314860f24b71.html - Status: 200 - Time: 3.26ms
2026-02-17 12:08:31,683 - CubieApp - INFO - Incoming request: GET /static/demo/7604c5fc427c41159add314860f24b71.html
2026-02-17 12:08:31,685 - CubieApp - INFO - Completed request: GET /static/demo/7604c5fc427c41159add314860f24b71.html - Status: 304 - Time: 2.36ms
2026-02-17 12:12:47,997 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 12:12:47,998 - CubieApp - INFO - Query='email this to me at pratnapurkar@tcube360.com...', explicit_mode='analytics', detected_intent='email'
2026-02-17 12:12:51,145 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:12:51,148 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 3150.83ms
2026-02-17 12:13:02,822 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 12:13:02,823 - CubieApp - INFO - Query='Yes, send me the bar chart...', explicit_mode='analytics', detected_intent='email'
2026-02-17 12:13:02,823 - CubieApp - INFO - User approved email in analytics mode, checking for draft...
2026-02-17 12:13:05,333 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:13:05,336 - root - INFO - SQL run: SELECT TOP 5 CarrierCode, COUNT(*) AS DisputeCount FROM DisputeManagement GROUP BY CarrierCode ORDER BY DisputeCount DESC
2026-02-17 12:13:09,893 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:13:09,896 - CubieApp - INFO - Resolved emails for ['pratnapurkar@tcube360.com']: ['pratnapurkar@tcube360.com']
2026-02-17 12:13:09,904 - CubieApp - WARNING - File not found, skipping: /mnt/data/top_5_carriers_dispute_count_bar_chart.html
2026-02-17 12:13:09,906 - CubieApp - INFO - Successfully attached: 7604c5fc427c41159add314860f24b71.html
2026-02-17 12:13:09,920 - CubieApp - INFO - Attempting to connect to SMTP server smtp.gmail.com:587
2026-02-17 12:13:34,572 - CubieApp - INFO - Email sent successfully to ['pratnapurkar@tcube360.com']
2026-02-17 12:13:36,750 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:13:36,755 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 33932.86ms
2026-02-17 12:13:36,757 - CubieApp - INFO - Incoming request: GET /.well-known/appspecific/com.chrome.devtools.json
2026-02-17 12:13:36,757 - CubieApp - INFO - Completed request: GET /.well-known/appspecific/com.chrome.devtools.json - Status: 404 - Time: 0.00ms
2026-02-17 12:27:14,699 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 12:27:14,701 - CubieApp - INFO - Query='what are the top 5 carriers based on shipment coun...', explicit_mode='analytics', detected_intent='analytics'
2026-02-17 12:27:16,892 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:27:16,902 - root - INFO - SQL run: SELECT TOP 5 TCCarrierCode AS Carrier, COUNT(*) AS Shipments FROM Shipment WHERE YEAR(ShipmentDate) = 2025 AND MONTH(ShipmentDate) = 11 GROUP BY TCCarrierCode ORDER BY Shipments DESC
2026-02-17 12:27:21,724 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:27:21,726 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 7026.98ms
2026-02-17 12:27:21,728 - httpx - INFO - HTTP Request: POST http://testserver/api/query "HTTP/1.1 200 OK"
2026-02-17 12:27:55,900 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 12:27:55,900 - CubieApp - INFO - Query='what are the top 5 carriers based on shipment coun...', explicit_mode='analytics', detected_intent='analytics'
2026-02-17 12:27:57,957 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:27:57,962 - root - INFO - SQL run: SELECT TOP 5 TCCarrierCode, COUNT(*) AS shipment_count FROM Shipment WHERE YEAR(ShipmentDate)=2025 AND MONTH(ShipmentDate)=11 GROUP BY TCCarrierCode ORDER BY shipment_count DESC
2026-02-17 12:28:02,303 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:28:02,306 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 6406.66ms
2026-02-17 12:28:02,307 - httpx - INFO - HTTP Request: POST http://testserver/api/query "HTTP/1.1 200 OK"
2026-02-17 12:28:38,430 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 12:28:38,431 - CubieApp - INFO - Query='what are the top 5 carriers based on shipment coun...', explicit_mode='analytics', detected_intent='analytics'
2026-02-17 12:28:40,663 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:28:40,666 - root - INFO - SQL run: SELECT TOP 5 TCCarrierCode, COUNT(*) AS shipment_count FROM Shipment WHERE YEAR(ShipmentDate)=2025 AND MONTH(ShipmentDate)=11 GROUP BY TCCarrierCode ORDER BY shipment_count DESC
2026-02-17 12:28:45,345 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:28:45,347 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 6916.64ms
2026-02-17 12:28:45,349 - httpx - INFO - HTTP Request: POST http://testserver/api/query "HTTP/1.1 200 OK"
2026-02-17 12:59:06,880 - CubieApp - INFO - Incoming request: POST /api/query
2026-02-17 12:59:06,880 - CubieApp - INFO - Query='what are the top 5 carriers based on shipment coun...', explicit_mode='analytics', detected_intent='analytics'
2026-02-17 12:59:09,530 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:59:09,536 - root - INFO - SQL run: SELECT TOP 5 TCCarrierCode, COUNT(*) AS shipment_count FROM Shipment WHERE YEAR(ShipmentDate)=2025 AND MONTH(ShipmentDate)=11 GROUP BY TCCarrierCode ORDER BY shipment_count DESC
2026-02-17 12:59:14,316 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent "HTTP/1.1 200 OK"
2026-02-17 12:59:14,318 - CubieApp - INFO - Completed request: POST /api/query - Status: 200 - Time: 7437.27ms
2026-02-17 12:59:14,320 - httpx - INFO - HTTP Request: POST http://testserver/api/query "HTTP/1.1 200 OK"
